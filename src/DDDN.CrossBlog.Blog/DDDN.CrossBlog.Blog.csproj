<Project Sdk="Microsoft.NET.Sdk.Web" InitialTargets="">

  <PropertyGroup>
    <TargetFramework>netcoreapp2.0</TargetFramework>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    <WWWOutputDir>wwwroot</WWWOutputDir>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\..\Localization\src\DDDN.Localization.OpenXML\DDDN.Localization.OpenXML.csproj" />
  </ItemGroup>

  <PropertyGroup>
    <Product>DDDN CrossBlog</Product>
    <Copyright>Copyright(C) 2017 Lukasz Jaskiewicz</Copyright>
    <Authors>Lukasz Jaskiewicz (lukasz@jaskiewicz.de, devdone@outlook.com)</Authors>
    <Description>DDDN CrossBlog</Description>
    <PackageProjectUrl>www.jaskiewicz.de</PackageProjectUrl>
    <Version>0.0.0.1</Version>
    <AssemblyVersion>0.0.0.1</AssemblyVersion>
    <NeutralLanguage>en-US</NeutralLanguage>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="BuildWebCompiler" Version="1.11.326" />
    <PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.0-preview2-final" />
    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.0.0-preview2-final" />
    <DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.Dotnet" Version="2.0.0-preview2-final" />
  </ItemGroup>

  <ItemGroup>
    <Folder Include="wwwroot\" />
  </ItemGroup>

  <Target Name="CopyFiles" BeforeTargets="Build">

    <PropertyGroup Label="InputDirectories">
      <JsDirIn>$(MSBuildProjectDirectory)\js</JsDirIn>
      <CssDirIn>$(MSBuildProjectDirectory)\css</CssDirIn>
      <ResDirIn>$(MSBuildProjectDirectory)\res</ResDirIn>
      <NpmFAFontsDirIn>$(MSBuildProjectDirectory)\node_modules\font-awesome\fonts</NpmFAFontsDirIn>
    </PropertyGroup>

    <PropertyGroup Label="OutputDirectories">
      <WWWDirOut>$(MSBuildProjectDirectory)\$(WWWOutputDir)</WWWDirOut>
      <JsDirOut>$(MSBuildProjectDirectory)\$(WWWOutputDir)\js</JsDirOut>
      <CssDirOut>$(MSBuildProjectDirectory)\$(WWWOutputDir)\css</CssDirOut>
      <ResDirOut>$(MSBuildProjectDirectory)\$(WWWOutputDir)\res</ResDirOut>
      <NpmFAFontsDirOut>$(MSBuildProjectDirectory)\$(WWWOutputDir)\fonts</NpmFAFontsDirOut>
    </PropertyGroup>

    <ItemGroup>
      <ResDirInFiles Include="$(ResDirIn)\**\*.*" />
      <NpmFAFontsDirInFiles Include="$(NpmFAFontsDirIn)\**\*.*" />
    </ItemGroup>

    <Message Text="Making output dirs..." Importance="high"></Message>
    <MakeDir Condition="" Directories="$(WWWDirOut)" ContinueOnError="false" />
    <MakeDir Condition="" Directories="$(JsDirOut)" ContinueOnError="false" />
    <MakeDir Condition="" Directories="$(CssDirOut)" ContinueOnError="false" />
    <MakeDir Condition="" Directories="$(ResDirOut)" ContinueOnError="false" />
    <MakeDir Condition="" Directories="$(NpmFAFontsDirOut)" ContinueOnError="false" />
    <Message Text="Done Making output dirs." Importance="high"></Message>

    <Message Text="Copying files..." Importance="high"></Message>
    <Copy SourceFiles="@(ResDirInFiles)" DestinationFiles="@(ResDirInFiles->'$(ResDirOut)\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Copy SourceFiles="@(ImagesDirInFiles)" DestinationFiles="@(ImagesDirInFiles->'$(ImagesDirOut)\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Copy SourceFiles="@(NpmFAFontsDirInFiles)" DestinationFiles="@(NpmFAFontsDirInFiles->'$(NpmFAFontsDirOut)\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Message Text="Done Copying files." Importance="high"></Message>
  </Target>

</Project>